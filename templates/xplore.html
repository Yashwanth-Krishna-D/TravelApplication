{% extends "base.html" %}
{% block content %}
<div class="row mb-4">
    <div class="col-12">
        <h2 class="text-gradient mb-3">Discover Destinations</h2>
        <p class="lead">Explore amazing destinations around the world and find your next adventure.</p>
    </div>
</div>

<!-- Search Bar -->
<div class="row mb-4">
    <div class="col-md-8 mx-auto">
        <form method="GET" action="{{ url_for('xplore') }}" class="search-container">
            <div class="input-group">
                <input type="text" 
                       class="form-control search-input" 
                       name="search" 
                       value="{{ search_query }}" 
                       placeholder="Search destinations, countries, or activities...">
                <button class="btn btn-custom" type="submit">
                    <i class="fas fa-search"></i> Search
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Search Results Info -->
{% if search_query %}
<div class="row mb-4">
    <div class="col-12">
        <div class="alert alert-info alert-custom">
            <i class="fas fa-search"></i> 
            Showing results for "{{ search_query }}" 
            ({{ destinations|length }} destination{{ 's' if destinations|length != 1 else '' }} found)
            <a href="{{ url_for('xplore') }}" class="btn btn-sm btn-outline-custom ms-3">Clear Search</a>
        </div>
    </div>
</div>
{% endif %}

<!-- Destinations Grid -->
<div class="row">
    {% if destinations %}
        {% for key, destination in destinations.items() %}
        <div class="col-lg-4 col-md-6 mb-4">
            <div class="destination-card shadow-hover">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <h5 class="mb-0">{{ destination.name }}</h5>
                    <span class="badge bg-primary">{{ destination.countries|length }} countries</span>
                </div>
                
                <p class="text-muted mb-3">{{ destination.description }}</p>
                
                <div class="mb-3">
                    <strong>Popular Countries:</strong>
                    <div class="mt-2">
                        {% for country in destination.countries[:4] %}
                        <span class="badge bg-light text-dark me-1 mb-1">{{ country }}</span>
                        {% endfor %}
                        {% if destination.countries|length > 4 %}
                        <span class="badge bg-light text-dark">+{{ destination.countries|length - 4 }} more</span>
                        {% endif %}
                    </div>
                </div>
                
                <div class="mb-3">
                    <strong>Highlights:</strong>
                    <div class="mt-2">
                        {% for highlight in destination.highlights %}
                        <span class="badge bg-success me-1 mb-1">{{ highlight }}</span>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="row mb-3">
                    <div class="col-6">
                        <small class="text-muted">
                            <i class="fas fa-calendar"></i> Best Time:<br>
                            <strong>{{ destination.best_time }}</strong>
                        </small>
                    </div>
                    <div class="col-6">
                        <small class="text-muted">
                            <i class="fas fa-dollar-sign"></i> Budget Range:<br>
                            <strong>{{ destination.budget_range }}</strong>
                        </small>
                    </div>
                </div>
                
                <div class="d-flex justify-content-between align-items-center">
                    <a href="{{ url_for('destination_detail', continent=key) }}" class="btn btn-sm btn-outline-custom">
                        <i class="fas fa-info-circle"></i> Learn More
                    </a>
                    <a href="{{ url_for('planner') }}?destination={{ destination.name }}" class="btn btn-sm btn-custom">
                        <i class="fas fa-route"></i> Plan Trip
                    </a>
                </div>
            </div>
        </div>
        {% endfor %}
    {% else %}
        <div class="col-12">
            <div class="text-center py-5">
                <i class="fas fa-search fa-3x text-muted mb-3"></i>
                <h4 class="text-muted">No destinations found</h4>
                <p class="text-muted">Try adjusting your search terms or browse all destinations.</p>
                <a href="{{ url_for('xplore') }}" class="btn btn-custom">View All Destinations</a>
            </div>
        </div>
    {% endif %}
</div>

<!-- Quick Stats -->
{% if not search_query %}
<div class="row mt-5">
    <div class="col-12">
        <div class="card-custom text-center">
            <h4 class="mb-3">Travel XP Destination Stats</h4>
            <div class="row">
                <div class="col-md-3">
                    <div class="stats-number">{{ destinations|length }}</div>
                    <div class="stats-label">Continents</div>
                </div>
                <div class="col-md-3">
                    <div class="stats-number">
                        {% set total_countries = 0 %}
                        {% for destination in destinations.values() %}
                            {% set total_countries = total_countries + destination.countries|length %}
                        {% endfor %}
                        {{ total_countries }}
                    </div>
                    <div class="stats-label">Countries</div>
                </div>
                <div class="col-md-3">
                    <div class="stats-number">
                        {% set total_highlights = 0 %}
                        {% for destination in destinations.values() %}
                            {% set total_highlights = total_highlights + destination.highlights|length %}
                        {% endfor %}
                        {{ total_highlights }}
                    </div>
                    <div class="stats-label">Highlights</div>
                </div>
                <div class="col-md-3">
                    <div class="stats-number">24/7</div>
                    <div class="stats-label">Planning Support</div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endif %}

<!-- Font Awesome for icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}
